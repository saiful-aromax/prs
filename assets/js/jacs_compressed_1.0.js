var current_year = new Date().getFullYear();
var JACS=new function(){ var f=new Date(Date.parse(new Date().toDateString()));var e=new Array();function b(j){if(document.getElementById(j)||(!document.getElementById(j)&&document.getElementsByName(j).length==0)){return document.getElementById(j)}else{if(document.getElementsByName(j).length==1){return document.getElementsByName(j)[0]}else{if(document.getElementsByName(j).length>1){alert("JACS \nCannot uniquely identify element named: "+j+".\nMore than one identical NAME attribute defined.\nSolution: Assign the required element a unique ID attribute value.")}}}}document.writeln("<!--[if IE]><div id='jacsIE'></div><![endif]-->");document.writeln("<!--[if lt IE 7]><div id='jacsIElt7'></div><![endif]-->");document.writeln('<style type="text/css">.jacs, .jacsStatic {padding:0px;vertical-align:middle;}iframe.jacs        {position:absolute;visibility:hidden;top:0px;left:0px;width:1px;height:1px;}table.jacs, table.jacsStatic   {padding:0px;visibility:hidden;cursor:default;text-align:center;}table.jacs         {top:0px;left:0px;position:absolute;}</style>');document.writeln('<style type="text/css">/* IMPORTANT:  The JACS calendar script requires all                the classes defined here. */table.jacs,table.jacsStatic   {padding:       1px;vertical-align:middle;border:        ridge 2px;font-size:     10pt;font: 11px "Trebuchet MS","Lucida Grande",Verdana,sans-serif;font-weight:   normal;}td.jacsDrag,td.jacsHead                 {padding:       0px 0px;text-align:    center;}td.jacsDrag                 {font-size:     8pt;}select.jacsHead             {margin:        0px 0px;}input.jacsHead              {height:        auto;width:         auto;vertical-align:middle;text-align:    center;margin:        0px 0px;font-weight:   normal;font-size:     10pt;font-family:   fixedSys;}td.jacsWeekNumberHead,td.jacsWeek                 {padding:       0px;text-align:    center;text-shadow: 0 1px 2px #BAB9B9;font-weight:   normal;}td.jacsNow,td.jacsNowHover,td.jacsNow:hover,td.jacsNowDisabled          {padding:       0px;text-align:    center;vertical-align:middle;font-size:     8pt;font-weight:   normal;}table.jacsCells             {text-align:    right;font-size:     8pt;width:         96%;}td.jacsCells,td.jacsCellsHover,td.jacsCells:hover,td.jacsCellsDisabled,td.jacsCellsExMonth,td.jacsCellsExMonthHover,td.jacsCellsExMonth:hover,td.jacsCellsExMonthDisabled,td.jacsCellsWeekend,td.jacsCellsWeekendHover,td.jacsCellsWeekend:hover,td.jacsCellsWeekendDisabled,td.jacsCellsHighlighted,td.jacsCellsHighlightedHover,td.jacsCellsHighlighted:hover,td.jacsCellsHighlightedWeekend,td.jacsCellsHighlightedWeekendHover,td.jacsCellsHighlightedWeekend:hover,td.jacsInputDate,td.jacsInputDateHover,td.jacsInputDate:hover,td.jacsInputDateDisabled,td.jacsWeekNo,td.jacsWeeks                {padding:           0px;width:             auto;height:            auto;border-width:      1px;border-style:      solid;font-weight:       normal;vertical-align:    middle;}/* Blend the colours into your page here...    *//* Calendar background */table.jacs,table.jacsStatic            {background-color: #EEEEEE;}/* Drag Handle */td.jacsDrag                 {background-color:  #9999CC;color:             #CCCCFF;}/* Week number heading */td.jacsWeekNumberHead       {color:             #6666CC;}/* Week day headings */td.jacsWeek                 {color: #5B5A5A;}/* Week numbers */td.jacsWeekNo               {background-color:  #776677;color:             #CCCCCC;}/* Enabled Days *//* Week Day */td.jacsCells                {background-color:  #CCCCCC;color:#1C94C3;;}/* Day matching the input date */td.jacsInputDate            {background-color:  #CC9999;color:             #FF0000;}/* Weekend Day */td.jacsCellsWeekend         {background-color:  #CCCCCC;color:             #CC6666;}/* Day outside the current month */td.jacsCellsExMonth         {background-color:  #CCCCCC;color:             #999;}/* Today selector */td.jacsNow                  {background-color:  #6666CC;color:#1C94C3;}/* MouseOver/Hover formatting        If you want to "turn off" any of the formatting        then just set to the same as the standard format       above.         Note: The reason that the following are       implemented using both a class and a :hover       pseudoclass is because Opera handles the rendering       involved in the class-swap very poorly and IE6        (and below) only implements pseudoclasses on the       anchor tag.*//* Highlighted Days *//* Week Day */td.jacsCellsHighlighted     {background-color:  #FFF0A5;border: solid 1px #FED22F;color:             #111;}/* Weekend Day */td.jacsCellsHighlightedWeekend {background-color: #E0E0E0;color:             #CC6666;}/* Active cells */td.jacsCells:hover,td.jacsCellsHover,td.jacsCellsHighlighted:hover,td.jacsCellsHighlightedHover,td.jacsCellsHighlightedWeekend:hover,td.jacsCellsHighlightedWeekendHover {background-color:  #FFF0A5;cursor:            pointer;color:             #000000;}/* Day matching the input date */td.jacsInputDate:hover,td.jacsInputDateHover       {background-color:  #FFF0A5;cursor:            pointer;color:             #000000;}/* Weekend cells */td.jacsCellsWeekend:hover,td.jacsCellsWeekendHover    {background-color:  #FFF0A5;cursor:            pointer;color:             #000000;}/* Day outside the current month */td.jacsCellsExMonth:hover,td.jacsCellsExMonthHover    {background-color:  #FFF4BB;cursor:            pointer;color:             #000000;}/* Clear Button */td.Clear                    {padding:           0px;}input.Clear                 {padding:           0px;text-align:     center;font-size:         8pt;}/* Today selector */td.jacsNow:hover,td.jacsNowHover             {color:             #444;cursor:            pointer;font-weight:       normal;}/* Disabled cells *//* Week Day *//* Day matching the input date */td.jacsInputDateDisabled    {background-color:  #999999;color:             #000000;}td.jacsCellsDisabled        {background-color:  #999999;color:             #000000;}/* Weekend Day */td.jacsCellsWeekendDisabled {background-color:  #999999;color:             #CC6666;}/* Day outside the current month */td.jacsCellsExMonthDisabled {background-color:  #999999;color:             #666666;}td.jacsNowDisabled          {background-color:  #6666CC;color:             #FFFFFF;}</style>');function g(k){switch(k.id){case"EnterYourIDHere":break;default:k.zIndex=2000;k.baseYear=f.getFullYear()-64;k.dropDownYears=f.getFullYear() - k.baseYear + 20;k.weekStart=0;k.weekNumberBaseDay=4;k.weekNumberDisplay=true;k.defaultToCurrentMonth=false;try{jacsSetLanguage(k)}catch(j){k.language="en";k.today="Today:";k.clear="Clear";k.drag="click here to drag";k.monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];k.weekInits=["S","M","T","W","T","F","S"];k.invalidDateMsg="The entered date is invalid.\n";k.outOfRangeMsg="The entered date is out of range.";k.doesNotExistMsg="The entered date does not exist.";k.invalidAlert=["Invalid date (",") ignored."];k.dateSettingError=["Error "," is not a Date object."];k.rangeSettingError=["Error "," should consist of two elements."]}k.showInvalidDateMsg=true;k.showOutOfRangeMsg=true;k.showDoesNotExistMsg=true;k.showInvalidAlert=true;k.showDateSettingError=true;k.showRangeSettingError=true;k.active=true;k.delimiters=["/","-",".",":",","," "];k.dateDisplayFormat="dd/mm/yyyy";k.dateFormat="yyyy-mm-dd";k.strict=false;k.clearButton=true;k.valuesEnabled=false;k.dayCells=[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true];k.dates=new Array();k.highlightDates=new Array();k.outOfRangeDisable=true;k.outOfMonthDisable=false;k.outOfMonthHide=false;k.formatTodayCell=true;k.todayCellBorderColour="#CB2727";k.allowDrag=false;k.onBlurMoveNext=false;k.clickToHide=false;k.xBase="L";k.yBase="B";k.xPosition="L";k.yPosition="T";k.autoPosition=true}k.dateReturned=false;k.outputDate=new Date(0);k.seedDate=new Date();k.fullInputDate=false;k.activeToday=true;k.monthSum=0;k.days=new Array();k.arrOnNext=new Array();k.triggerEle;k.targetEle}Date.prototype.jacsFormat=function(o,l){var k=0,n="",j="";for(var m=0;m<=o.length;m++){if(m<o.length&&o.charAt(m)==n){k++}else{switch(n){case"y":case"Y":j+=(this.getFullYear()%Math.pow(10,k)).toString().jacsPadLeft(k);break;case"m":case"M":j+=(k<3)?(this.getMonth()+1).toString().jacsPadLeft(k):l[this.getMonth()];break;case"d":case"D":j+=this.getDate().toString().jacsPadLeft(k);break;default:while(k-->0){j+=n}}if(m<o.length){n=o.charAt(m);k=1}}}return j};String.prototype.jacsPadLeft=function(l){var j="";for(var k=0;k<(l-this.length);k++){j+="0"}return(j+this)};Function.prototype.jacsRunNext=function(){var k=this,j=arguments[0];k.JACSid=arguments[1];return function(){return k.apply(this,j)}};if(document.addEventListener){window.addEventListener("load",a,true)}else{window.attachEvent("onload",a)}function a(){if(document.addEventListener){document.addEventListener("click",d,false)}else{document.attachEvent("onclick",d)}if(b("jacsIElt7")){window.attachEvent("onbeforeunload",j)}function j(){for(var o=0;o<e.length;o++){b(e[o]+"Week_").style.display="";for(var n=0;n<6;n++){b(e[o]+"Week_"+n).style.display=""}b(e[o]+"Now").onclick=null;b(e[o]+"Now").onmouseover=null;b(e[o]+"Now").onmouseout=null;b(e[o]+"ClearButton").onclick=null;var q=b(e[o]),m=b(e[o]+"Cells").childNodes;for(var n=0;n<m.length;n++){var p=m[n].childNodes;for(var l=1;l<p.length;l++){p[l].onclick=null;p[l].onmouseover=null;p[l].onmouseout=null}}q.arrOnNext=null;q.targetEle=null}}}function c(s,G){var y=b(G),v=new Date(Date.parse(new Date().toDateString())),p=new Date();v.setHours(12);selYears=b(G+"Years");selMonths=b(G+"Months");if(selYears.options.selectedIndex>-1){y.monthSum=12*(selYears.options.selectedIndex)+s}if(selMonths.options.selectedIndex>-1){y.monthSum+=selMonths.options.selectedIndex}v.setFullYear(y.baseYear+Math.floor(y.monthSum/12),(y.monthSum%12),1);b(G+"Week_").style.display=(y.weekNumberDisplay)?"":"none";if(window.opera){selMonths.style.display="inherit";selYears.style.display="inherit"}tmp=(12*parseInt((v.getFullYear()-y.baseYear),10))+parseInt(v.getMonth(),10);if(tmp>-1&&tmp<(12*y.dropDownYears)){selYears.options.selectedIndex=Math.floor(y.monthSum/12);selMonths.options.selectedIndex=(y.monthSum%12);curMonth=v.getMonth();v.setDate((((v.getDay()-y.weekStart)<0)?-6:1)+y.weekStart-v.getDay());var n=new Date(v.getFullYear(),v.getMonth(),v.getDate()).valueOf();p=new Date(v);var o=b(G+"Now");function z(){m(f,G)}if(y.dates.length==0){if(y.active&&y.activeToday){o.onclick=z;o.className="jacsNow";if(b("jacsIE")){o.onmouseover=A;o.onmouseout=A}if(document.removeEventListener){o.removeEventListener("click",h,false)}else{o.detachEvent("onclick",h)}}else{o.onclick=null;o.className="jacsNowDisabled";if(b("jacsIE")){o.onmouseover=null;o.onmouseout=null}if(document.addEventListener){o.addEventListener("click",h,false)}else{o.attachEvent("onclick",h)}}}else{for(var B=0;B<y.dates.length;B++){if(!y.activeToday||(typeof y.dates[B]=="object"&&((y.dates[B].constructor==Date&&f.valueOf()==y.dates[B].valueOf())||(y.dates[B].constructor==Array&&f.valueOf()>=y.dates[B][0].valueOf()&&f.valueOf()<=y.dates[B][1].valueOf())))){o.onclick=(y.active&&y.valuesEnabled)?z:null;o.className=(y.active&&y.valuesEnabled)?"jacsNow":"jacsNowDisabled";if(b("jacsIE")){o.onmouseover=(y.active&&y.valuesEnabled)?A:null;o.onmouseout=(y.active&&y.valuesEnabled)?A:null}if(y.active&&y.valuesEnabled){if(document.removeEventListener){o.removeEventListener("click",h,false)}else{o.detachEvent("onclick",h)}}else{if(document.addEventListener){o.addEventListener("click",h,false)}else{o.attachEvent("onclick",h)}}break}else{o.onclick=(y.active&&y.valuesEnabled)?null:z;o.className=(y.active&&y.valuesEnabled)?"jacsNowDisabled":"jacsNow";if(b("jacsIE")){o.onmouseover=(y.active&&y.valuesEnabled)?null:A;o.onmouseout=(y.active&&y.valuesEnabled)?null:A}if(y.active&&y.valuesEnabled){if(document.addEventListener){o.addEventListener("click",h,false)}else{o.attachEvent("onclick",h)}}else{if(document.removeEventListener){o.removeEventListener("click",h,false)}else{o.detachEvent("onclick",h)}}}}}function m(L,N){var k=b(N);if(typeof k.targetEle.value=="undefined"){k.triggerEle.textNode.replaceData(0,k.triggerEle.len,L.jacsFormat(k.dateFormat,k.monthNames))}else{k.ele.value=L.jacsFormat(k.dateFormat,k.monthNames)}k.dateReturned=true;k.outputDate=L;if(k.dynamic){d(N)}else{if(typeof k.onNext!="undefined"&&k.onNext!=null){k.onNext()}JACS.show(k.ele,k.id,k.days)}if(k.onBlurMoveNext){var M="INPUT;A;SELECT;TEXTAREA;BUTTON;AREA;OBJECT",O=false;if(k.ele.tabIndex>0){var P=M.split(";");tagsOuterLoop:for(var J=0;P.length;J++){elementsByTag=document.getElementsByTagName(P[J]);for(var I=0;I<elementsByTag.length;I++){if(elementsByTag[I].tabIndex==(k.ele.tabIndex+1)&&!elementsByTag[I].disabled&&elementsByTag[I].type!="hidden"&&elementsByTag[I].style.display!="none"&&elementsByTag[I].style.visibility!="hidden"){elementsByTag[I].focus();O=true;break tagsOuterLoop}}}}if(!O){function K(){var R=new Array,Q=new Array;function j(U){for(var T=0;T<U.childNodes.length;T++){var S=U.childNodes[T];if(S.nodeType==1&&S.style.display!="none"&&!S.disabled&&S.type!="hidden"&&S.style.visibility!="hidden"){if(M.indexOf(S.tagName)>-1){if(S.tabIndex>0){R[S.tabIndex]=S}else{Q[Q.length]=S}}j(S)}}}j(document.body);while(R.length>0&&R[0]==null){R.shift()}return R.concat(Q)}var H=K();for(var J=0;J<H.length;J++){if(H[J]==k.targetEle){if(J<(H.length-1)){H[J+1].focus()}else{H[0].focus()}break}}}}else{if(!k.targetEle.disabled&&k.targetEle.style.display!="none"&&k.targetEle.type!="hidden"&&k.targetEle.style.visibility!="hidden"){k.targetEle.focus()}}}function A(j){var k=t(j);if(k.nodeType==3){k=k.parentNode}if(((j)?j.type:event.type)=="mouseover"){switch(k.className){case"jacsCells":k.className="jacsCellsHover";break;case"jacsCellsHighlighted":k.className="jacsCellsHighlightedHover";break;case"jacsCellsExMonth":k.className="jacsCellsExMonthHover";break;case"jacsCellsWeekend":k.className="jacsCellsWeekendHover";break;case"jacsCellsHighlightedWeekend":k.className="jacsCellsHighlightedWeekendHover";break;case"jacsNow":k.className="jacsNowHover";break;case"jacsInputDate":k.className="jacsInputDateHover"}}else{switch(k.className){case"jacsCellsHover":k.className="jacsCells";break;case"jacsCellsHighlightedHover":k.className="jacsCellsHighlighted";break;case"jacsCellsExMonthHover":k.className="jacsCellsExMonth";break;case"jacsCellsWeekendHover":k.className="jacsCellsWeekend";break;case"jacsCellsHighlightedWeekendHover":k.className="jacsCellsHighlightedWeekend";break;case"jacsNowHover":k.className="jacsNow";break;case"jacsInputDateHover":k.className="jacsInputDate"}}return true}function t(j){if(!j){j=event}return j.target||j.srcElement}function E(J){var I=new Date(J);I.setDate(I.getDate()-I.getDay()+y.weekNumberBaseDay+((J.getDay()>y.weekNumberBaseDay)?7:0));var H=new Date(I.getFullYear(),0,1);H.setDate(H.getDate()-H.getDay()+y.weekNumberBaseDay);if(H<new Date(I.getFullYear(),0,1)){H.setDate(H.getDate()+7)}var k=new Date(H-y.weekNumberBaseDay+J.getDay());if(k>H){k.setDate(k.getDate()-7)}var j="0"+(Math.round((I-H)/604800000,0)+1);return j.substring(j.length-2,j.length)}var q=b(G+"Cells").childNodes;for(var D=0;D<q.length;D++){var w=q[D];if(w.nodeType==1&&w.tagName=="TR"){tmpEl=w.childNodes[0];if(y.weekNumberDisplay){tmpEl.innerHTML=E(v);tmpEl.style.borderColor=(tmpEl.currentStyle)?tmpEl.currentStyle.backgroundColor:(document.defaultView.getComputedStyle)?document.defaultView.getComputedStyle(tmpEl,null).backgroundColor:"";tmpEl.style.display=""}else{tmpEl.style.display="none"}for(var C=1;C<w.childNodes.length;C++){var x=w.childNodes[C];if(x.nodeType==1&&x.tagName=="TD"){w.childNodes[C].innerHTML=v.getDate();var l=w.childNodes[C];l.style.visibility=(y.outOfMonthHide&&(v<(new Date(v.getFullYear(),curMonth,1,v.getHours()))||v>(new Date(v.getFullYear(),curMonth+1,0,v.getHours()))))?"hidden":"inherit";var r=y.valuesEnabled;if((y.outOfRangeDisable&&(v<(new Date(y.baseYear,0,1,12))||v>(new Date(y.baseYear+y.dropDownYears,0,0,12))))||(y.outOfMonthDisable&&(v<(new Date(v.getFullYear(),curMonth,1,v.getHours()))||v>(new Date(v.getFullYear(),curMonth+1,0,v.getHours()))))){r=true}else{if((y.days.join().search(((C-1+(7*(D*q.length/6))+y.weekStart)%7))>-1)||!y.dayCells[C-1+(7*((D*q.length)/6))]){r=!y.valuesEnabled}else{for(var B=0;B<y.dates.length;B++){if(typeof y.dates[B]=="object"&&((y.dates[B].constructor==Date&&n==y.dates[B].valueOf())||(y.dates[B].constructor==Array&&n>=y.dates[B][0].valueOf()&&n<=y.dates[B][1].valueOf()))){r=!y.valuesEnabled;break}}}}if(r){w.childNodes[C].onclick=null;if(b("jacsIE")){w.childNodes[C].onmouseover=null;w.childNodes[C].onmouseout=null}l.className=(v.getMonth()!=curMonth)?"jacsCellsExMonthDisabled":(y.fullInputDate&&n==y.seedDate.valueOf())?"jacsInputDateDisabled":(v.getDay()%6==0)?"jacsCellsWeekendDisabled":"jacsCellsDisabled";l.style.borderColor=(y.formatTodayCell&&v.toDateString()==f.toDateString())?y.todayCellBorderColour:(l.currentStyle)?l.currentStyle.backgroundColor:(document.defaultView.getComputedStyle)?document.defaultView.getComputedStyle(l,null).backgroundColor:""}else{function F(j){var H=t(j),k=new Date(p);if(H.nodeType==3){H=H.parentNode}k.setDate(p.getDate()+parseInt(H.id.substr(G.length+5),10));m(k,G)}if(y.active){w.childNodes[C].onclick=F}if(b("jacsIE")){w.childNodes[C].onmouseover=A;w.childNodes[C].onmouseout=A}var u=false;for(var B=0;B<y.highlightDates.length;B++){if(typeof y.highlightDates[B]=="object"&&((y.highlightDates[B].constructor==Date&&n==y.highlightDates[B].valueOf())||(y.highlightDates[B].constructor==Array&&n>=y.highlightDates[B][0].valueOf()&&n<=y.highlightDates[B][1].valueOf()))){u=true;break}}l.className=(v.getMonth()!=curMonth)?"jacsCellsExMonth":(y.fullInputDate&&n==y.seedDate.valueOf())?"jacsInputDate":(v.getDay()%6==0)?(u)?"jacsCellsHighlightedWeekend":"jacsCellsWeekend":(u)?"jacsCellsHighlighted":"jacsCells";l.style.borderColor=(y.formatTodayCell&&v.toDateString()==f.toDateString())?y.todayCellBorderColour:(l.currentStyle)?l.currentStyle.backgroundColor:(document.defaultView.getComputedStyle)?document.defaultView.getComputedStyle(l,null).backgroundColor:"";l.style.BackgroundColor="#FFF0A5"}v.setDate(v.getDate()+1);n=new Date(v.getFullYear(),v.getMonth(),v.getDate()).valueOf()}}}}}if(window.opera){selMonths.style.display="inline";selYears.style.display="inline";y.style.visibility="hidden";y.style.visibility="inherit"}}function d(l){if(typeof l=="object"){for(var k=0;k<e.length;k++){j(e[k])}}else{j(l)}function j(m){cal=b(m);if(cal.dynamic){cal.style.visibility="hidden";b(m+"Iframe").style.visibility="hidden";i(cal)}}}function i(j){if(j.arrOnNext){if(j.arrOnNext.length>0){j.onNext=j.arrOnNext.shift();j.onNext();j.onNext=null}}}function h(j){if(j.stopPropagation){if(j.target!=j.currentTarget){j.stopPropagation();j.preventDefault()}}else{j.cancelBubble=true}}return{show:function(s){if(typeof arguments[1]=="object"){var o=true;if(typeof arguments[2]=="string"){var K=arguments[2],y=3}else{var K="jacs",y=2}var w=arguments[1];if(!w){w=window.event}if(w.tagName){var l=w;if(b("jacsIE")){window.event.cancelBubble=true}else{l.parentNode.addEventListener("click",h,false)}}else{var B=w;var l=(B.target)?B.target:B.srcElement;if(B.stopPropagation){B.stopPropagation()}else{B.cancelBubble=true}}}else{var l=s,o=false;if(typeof arguments[1]=="string"){var K=arguments[1],y=2}else{var K="jacs",y=1}}if(document.addEventListener){s.addEventListener("keydown",H,false);s.parentNode.addEventListener("click",h,false)}else{s.attachEvent("onkeydown",H);if(s.parentNode!=document.body){s.parentNode.attachEvent("onclick",h)}}function H(j){if(!j){var j=window.event}if((j.keyCode||j.which)==9){d(K)}}if(!b(K)){JACS.make(K,o)}cal=b(K);if(B){if(B.type=="focus"&&cal.dateReturned&&!cal.onBlurMoveNext&&cal.prevEventType=="focus"){h(B);cal.prevEventType="";cal.dateReturned=false;return false}cal.prevEventType=B.type}if(cal.style.visibility!="hidden"&&cal.style.visibility!="inherit"&&typeof i=="function"){i(cal)}cal.triggerEle=l;cal.dateReturned=false;cal.activeToday=true;if(arguments.length==y){cal.days.length=0}else{selectedDays=(typeof arguments[y]=="object")?arguments[y]:arguments;for(var C=(y|0);C<selectedDays.length;C++){if(cal.days.join().indexOf(selectedDays[C])==-1){cal.days.push(selectedDays[C])}}}for(var C=0;C<cal.days.length;C++){if(f.getDay()==cal.days[C]%7){cal.activeToday=false;break}}cal.seedDate=f;var F="";if(s.value){F=s.value.replace(/^\s+/,"").replace(/\s+$/,"")}else{if(typeof s.value=="undefined"){var m=s.childNodes;for(var C=0;C<m.length;C++){if(m[C].nodeType==3){F=m[C].nodeValue.replace(/^\s+/,"").replace(/\s+$/,"");if(F.length>0){cal.triggerEle.textNode=m[C];cal.triggerEle.len=m[C].nodeValue.length;break}}}}}var D=b(K+"Years").options;if(D.length==0||D[0].value!=cal.baseYear){D.length=0;for(var C=0;C<cal.dropDownYears;C++){D[C]=new Option((cal.baseYear+C),(cal.baseYear+C))}}if(F.length==0){cal.fullInputDate=false;if((new Date(cal.baseYear+cal.dropDownYears,0,0))<cal.seedDate||(new Date(cal.baseYear,0,1))>cal.seedDate){cal.seedDate=new Date(cal.baseYear+Math.floor(cal.dropDownYears/2),5,1)}}else{function z(){var M=new Array(),N=F.split(new RegExp("[\\"+cal.delimiters.join("\\")+"]+","g"));if(N[0]!=null){if(N[0].length==0){N.splice(0,1)}if(N[N.length-1].length==0){N.splice(N.length-1,1)}}cal.fullInputDate=false;cal.dateFormat=cal.dateFormat.toUpperCase();var P=["D","M","Y"];var j=new Array();for(var O=0;O<P.length;O++){if(cal.dateFormat.search(P[O])>-1){j[cal.dateFormat.search(P[O])]=P[O]}}cal.dateSequence=j.join("");switch(N.length){case 1:if(cal.dateFormat.indexOf("Y")>-1&&N[0].length>cal.dateFormat.lastIndexOf("Y")){M[0]=parseInt(N[0].substring(cal.dateFormat.indexOf("Y"),cal.dateFormat.lastIndexOf("Y")+1),10)}else{M[0]=parseInt(N[0],10)}if(cal.dateFormat.indexOf("M")>-1&&N[0].length>cal.dateFormat.lastIndexOf("M")){M[1]=N[0].substring(cal.dateFormat.indexOf("M"),cal.dateFormat.lastIndexOf("M")+1)}else{M[1]=cal.defaultToCurrentMonth?(f.getMonth()+1).toString():"6"}if(cal.dateFormat.indexOf("D")>-1&&N[0].length>cal.dateFormat.lastIndexOf("D")){M[2]=parseInt(N[0].substring(cal.dateFormat.indexOf("D"),cal.dateFormat.lastIndexOf("D")+1),10)}else{M[2]=1}if(N[0].length==cal.dateFormat.length){cal.fullInputDate=true}break;case 2:M[0]=parseInt(N[cal.dateSequence.replace(/D/i,"").search(/Y/i)],10);M[1]=N[cal.dateSequence.replace(/D/i,"").search(/M/i)];M[2]=1;break;case 3:M[0]=parseInt(N[cal.dateSequence.search(/Y/i)],10);M[1]=N[cal.dateSequence.search(/M/i)];M[2]=parseInt(N[cal.dateSequence.search(/D/i)],10);cal.fullInputDate=true;break;default:M[0]=0;M[1]=0;M[2]=0}var R=new RegExp("^(0?[1-9]|[1-2][0-9]|3[0-1])$"),L=new RegExp("^(0?[1-9]|1[0-2]|"+cal.monthNames.join("|")+")$","i"),Q=new RegExp("^([0-9]{1,2}|[0-9]{4})$");if(Q.exec(M[0])==null||L.exec(M[1])==null||R.exec(M[2])==null){if(cal.showInvalidDateMsg){alert(cal.invalidDateMsg+cal.invalidAlert[0]+F+cal.invalidAlert[1])}M[0]=cal.baseYear+Math.floor(cal.dropDownYears/2);M[1]=cal.defaultToCurrentMonth?(f.getMonth()+1).toString():"6";M[2]=1;cal.fullInputDate=false}return M}seedDate=z();if(seedDate[0]<100){seedDate[0]+=(seedDate[0]>50)?1900:2000}if(seedDate[1].search(/\d+/)<0){for(C=0;C<cal.monthNames.length;C++){if(seedDate[1].toUpperCase()==cal.monthNames[C].toUpperCase()){seedDate[1]=C+1;break}}}cal.seedDate=new Date(seedDate[0],seedDate[1]-1,seedDate[2])}if(isNaN(cal.seedDate)){if(cal.showInvalidDateMsg){alert(cal.invalidDateMsg+cal.invalidAlert[0]+F+cal.invalidAlert[1])}cal.seedDate=new Date(cal.baseYear+Math.floor(cal.dropDownYears/2),5,1);cal.fullInputDate=false}else{if((new Date(cal.baseYear,0,1))>cal.seedDate){if(cal.strict&&cal.showOutOfRangeMsg){alert(cal.outOfRangeMsg)}cal.seedDate=new Date(cal.baseYear,0,1);cal.fullInputDate=false}else{if((new Date(cal.baseYear+cal.dropDownYears,0,0))<cal.seedDate){if(cal.strict&&cal.showOutOfRangeMsg){alert(cal.outOfRangeMsg)}cal.seedDate=new Date(cal.baseYear+Math.floor(cal.dropDownYears),-1,1);cal.fullInputDate=false}else{if(cal.strict&&cal.fullInputDate&&(cal.seedDate.getDate()!=seedDate[2]||(cal.seedDate.getMonth()+1)!=seedDate[1]||cal.seedDate.getFullYear()!=seedDate[0])){if(cal.showDoesNotExistMsg){alert(cal.doesNotExistMsg)}cal.seedDate=new Date(cal.seedDate.getFullYear(),cal.seedDate.getMonth()-1,1);cal.fullInputDate=false}}}}for(var C=0;C<cal.dates.length;C++){if(!((typeof cal.dates[C]=="object")&&(cal.dates[C].constructor==Date))){if((typeof cal.dates[C]=="object")&&(cal.dates[C].constructor==Array)){var k=true;if(cal.dates[C].length!=2){if(cal.showRangeSettingError){alert(cal.rangeSettingError[0]+cal.dates[C]+cal.rangeSettingError[1])}k=false}else{for(var A=0;A<cal.dates[C].length;A++){if(!((typeof cal.dates[C][A]=="object")&&(cal.dates[C][A].constructor==Date))){if(cal.showRangeSettingError){alert(cal.dateSettingError[0]+cal.dates[C][A]+cal.dateSettingError[1])}k=false}}}if(k&&(cal.dates[C][0]>cal.dates[C][1])){cal.dates[C].reverse()}}else{if(cal.showRangeSettingError){alert(cal.dateSettingError[0]+cal.dates[C]+cal.dateSettingError[1])}}}}b(K+"DragText").innerHTML=cal.drag;var t=b(K+"Months").options,q="";if(t.length>0){for(var C=0;C<t.length;C++){q+=t[C].value+","}}if(t.length==0||(cal.monthNames.join()+",")!=q){t.length=0;if(cal.monthNames.length<t.length){t.length=cal.monthNames.length}for(var C=0;C<cal.monthNames.length;C++){if(C>t.length-1){t[C]=new Option(cal.monthNames[C],cal.monthNames[C])}else{t[C].innerHTML=cal.monthNames[C]}}}for(var C=0;C<cal.weekInits.length;C++){b(K+"WeekInit"+C).innerHTML=cal.weekInits[(C+cal.weekStart)%cal.weekInits.length]}if(((new Date(cal.baseYear+cal.dropDownYears,0,0))>f&&(new Date(cal.baseYear,0,0))<f)||(cal.clearButton&&(s.readOnly||s.disabled))){b(K+"Now").innerHTML=cal.today+" "+f.jacsFormat(cal.dateDisplayFormat,cal.monthNames);b(K+"ClearButton").value=cal.clear;b(K+"Foot").style.display="";if((new Date(cal.baseYear+cal.dropDownYears,0,0))>f&&(new Date(cal.baseYear,0,0))<f){b(K+"Now").style.display="";if(cal.clearButton&&(s.readOnly||s.disabled)){b(K+"Clear").style.display="";b(K+"Clear").style.textAlign="left";b(K+"Now").style.textAlign="right"}else{b(K+"Clear").style.display="none";b(K+"Now").style.textAlign="center"}}else{b(K+"Clear").style.textAlign="center";b(K+"Clear").style.display="";b(K+"Now").style.display="none"}}else{b(K+"Foot").style.display="none"}cal.monthSum=12*(cal.seedDate.getFullYear()-cal.baseYear)+cal.seedDate.getMonth();b(K+"Years").options.selectedIndex=Math.floor(cal.monthSum/12);b(K+"Months").options.selectedIndex=(cal.monthSum%12);b(K).ele=s;c(0,K);cal.targetEle=s;if(o){b(K+"Drag").style.display=(cal.allowDrag)?"":"none";var E=parseInt(s.offsetTop,10),p=parseInt(s.offsetLeft,10);if(!window.opera){while(s.tagName!="BODY"&&s.tagName!="HTML"){E-=parseInt(s.scrollTop,10);p-=parseInt(s.scrollLeft,10);s=s.parentNode}s=cal.targetEle}while(s.tagName!="BODY"&&s.tagName!="HTML"){s=s.offsetParent;E+=parseInt(s.offsetTop,10);p+=parseInt(s.offsetLeft,10)}s=cal.targetEle;var G=E,x=p;if(cal.xBase.length>0){if(isNaN(cal.xBase)){cal.xBase=cal.xBase.toUpperCase();p+=(cal.xBase=="R")?parseInt(s.offsetWidth,10):(cal.xBase=="M")?Math.round(parseInt(s.offsetWidth,10)/2):0}else{p+=parseInt(cal.xBase,10)}}if(cal.yBase.length>0){if(isNaN(cal.yBase)){cal.yBase=cal.yBase.toUpperCase();E+=(cal.yBase=="B")?parseInt(s.offsetHeight,10):(cal.yBase=="M")?Math.round(parseInt(s.offsetHeight,10)/2):0}else{E+=parseInt(cal.yBase,10)}}else{E+=parseInt(s.offsetHeight,10)}if(cal.xPosition.length>0){if(isNaN(cal.xPosition)){cal.xPosition=cal.xPosition.toUpperCase();p-=(cal.xPosition=="R")?parseInt(cal.offsetWidth,10):(cal.xPosition=="M")?Math.round(parseInt(cal.offsetWidth,10)/2):0}else{p+=parseInt(cal.xPosition,10)}}if(cal.yPosition.length>0){if(isNaN(cal.yPosition)){cal.yPosition=cal.yPosition.toUpperCase();E-=(cal.yPosition=="B")?parseInt(cal.offsetHeight,10):(cal.yPosition=="M")?Math.round((parseInt(cal.offsetHeight,10))/2):0}else{E+=parseInt(cal.yPosition,10)}}if(cal.autoPosition){var v=parseInt(cal.offsetWidth,10),u=parseInt(cal.offsetHeight,10),n=(document.body&&document.body.scrollLeft)?document.body.scrollLeft:(document.documentElement&&document.documentElement.scrollLeft)?document.documentElement.scrollLeft:0,J=(typeof(innerWidth)=="number")?innerWidth:(document.documentElement&&document.documentElement.clientWidth)?document.documentElement.clientWidth:(document.body&&document.body.clientWidth)?document.body.clientWidth:0,I=(document.body&&document.body.scrollTop)?document.body.scrollTop:(document.documentElement&&document.documentElement.scrollTop)?document.documentElement.scrollTop:0,r=(typeof(innerHeight)=="number")?innerHeight:(document.documentElement&&document.documentElement.clientHeight)?document.documentElement.clientHeight:(document.body&&document.body.clientHeight)?document.body.clientHeight:0;if(x+parseInt(s.offsetWidth,10)-v>=n&&p+v>n+J){p=x+parseInt(s.offsetWidth,10)-v}else{if(x>=n&&p<n){p=x}}if(G-u>=I&&E+u>I+r){E=G-u}else{if(E+u<=I+r&&E<I){E=G+parseInt(s.offsetHeight,10)}}}cal.style.top=E+"px";cal.style.left=p+"px";b(K+"Iframe").style.top=E+"px";b(K+"Iframe").style.left=p+"px";b(K+"Iframe").style.width=(cal.offsetWidth-(b("jacsIE")?2:4))+"px";b(K+"Iframe").style.height=(cal.offsetHeight-(b("jacsIE")?2:4))+"px";b(K+"Iframe").style.visibility="inherit"}cal.style.visibility="inherit"},make:function(m){e.push(m);var p=(typeof arguments[1]=="boolean")?arguments[1]:true;TABLEjacs=document.createElement("table");TABLEjacs.id=m;TABLEjacs.dynamic=p;TABLEjacs.className=(p)?"jacs":"jacsStatic";g(TABLEjacs);if(p){TABLEjacs.style.zIndex=TABLEjacs.zIndex+1}function n(j){if(TABLEjacs.clickToHide){d(m)}h(j)}TBODYjacs=document.createElement("tbody");TRjacs1=document.createElement("tr");TRjacs1.className="jacs";TDjacs1=document.createElement("td");TDjacs1.className="jacs";TABLEjacsHead=document.createElement("table");TABLEjacsHead.id=m+"Head";TABLEjacsHead.cellSpacing="0";TABLEjacsHead.cellPadding="0";TABLEjacsHead.className="jacsHead";TABLEjacsHead.width="100%";TBODYjacsHead=document.createElement("tbody");TRjacsDrag=document.createElement("tr");TRjacsDrag.id=m+"Drag";TRjacsDrag.style.display="none";TDjacsDrag=document.createElement("td");TDjacsDrag.className="jacsDrag";TDjacsDrag.colSpan="4";function o(s){var u=b(m);var r=s.clientX,j=s.clientY,t=u;while(t.tagName!="BODY"&&t.tagName!="HTML"){r-=parseInt(t.offsetLeft,10);j-=parseInt(t.offsetTop,10);t=t.offsetParent}if(document.addEventListener){u.addEventListener("mousemove",v,true);u.addEventListener("mouseup",q,true)}else{u.attachEvent("onmousemove",v);u.attachEvent("onmouseup",q);u.setCapture()}h(s);function v(w){if(!w){w=window.event}u.style.left=(w.clientX-r)+"px";u.style.top=(w.clientY-j)+"px";b(m+"Iframe").style.left=(w.clientX-r)+"px";b(m+"Iframe").style.top=(w.clientY-j)+"px";h(w)}function q(w){if(!w){w=window.event}if(document.removeEventListener){u.removeEventListener("mousemove",v,true);u.removeEventListener("mouseup",q,true)}else{u.detachEvent("onmouseup",q);u.detachEvent("onmousemove",v);u.releaseCapture()}h(w)}}DIVjacsDragText=document.createElement("span");DIVjacsDragText.id=m+"DragText";TRjacsHead=document.createElement("tr");TRjacsHead.className="jacsHead";TDjacsHead1=document.createElement("td");TDjacsHead1.className="jacsHead";INPUTjacsHead1=document.createElement("input");INPUTjacsHead1.className="jacsHead";INPUTjacsHead1.id=m+"HeadLeft";INPUTjacsHead1.type="button";INPUTjacsHead1.tabIndex="-1";INPUTjacsHead1.value="  ";INPUTjacsHead1.onclick=function(){c(-1,m)};TDjacsHead2=document.createElement("td");TDjacsHead2.className="jacsHead";SELECTjacsHead2=document.createElement("select");SELECTjacsHead2.className="jacsHead";SELECTjacsHead2.id=m+"Months";SELECTjacsHead2.tabIndex="-1";SELECTjacsHead2.onchange=function(){c(0,m)};TDjacsHead3=document.createElement("td");TDjacsHead3.className="jacsHead";SELECTjacsHead3=document.createElement("select");SELECTjacsHead3.className="jacsHead";SELECTjacsHead3.id=m+"Years";SELECTjacsHead3.tabIndex="-1";SELECTjacsHead3.onchange=function(){c(0,m)};TDjacsHead4=document.createElement("td");TDjacsHead4.className="jacsHead";INPUTjacsHead4=document.createElement("input");INPUTjacsHead4.className="jacsHead";INPUTjacsHead4.id=m+"HeadRight";INPUTjacsHead4.type="button";INPUTjacsHead4.tabIndex="-1";INPUTjacsHead4.value="  ";INPUTjacsHead4.onclick=function(){c(1,m)};TRjacs2=document.createElement("tr");TRjacs2.className="jacs";TDjacs2=document.createElement("td");TDjacs2.className="jacs";TABLEjacsCells=document.createElement("table");TABLEjacsCells.className="jacsCells";TABLEjacsCells.align="center";TABLEjacsCells.width="100%";THEADjacsCells=document.createElement("thead");TRjacsCells=document.createElement("tr");TDjacsCells=document.createElement("td");TDjacsCells.className="jacsWeekNumberHead";TDjacsCells.id=m+"Week_";TABLEjacs.appendChild(TBODYjacs);TBODYjacs.appendChild(TRjacs1);TRjacs1.appendChild(TDjacs1);TDjacs1.appendChild(TABLEjacsHead);TABLEjacsHead.appendChild(TBODYjacsHead);TBODYjacsHead.appendChild(TRjacsDrag);TRjacsDrag.appendChild(TDjacsDrag);TDjacsDrag.appendChild(DIVjacsDragText);TBODYjacsHead.appendChild(TRjacsHead);TRjacsHead.appendChild(TDjacsHead1);TDjacsHead1.appendChild(INPUTjacsHead1);TRjacsHead.appendChild(TDjacsHead2);TDjacsHead2.appendChild(SELECTjacsHead2);TRjacsHead.appendChild(TDjacsHead3);TDjacsHead3.appendChild(SELECTjacsHead3);TRjacsHead.appendChild(TDjacsHead4);TDjacsHead4.appendChild(INPUTjacsHead4);TBODYjacs.appendChild(TRjacs2);TRjacs2.appendChild(TDjacs2);TDjacs2.appendChild(TABLEjacsCells);TABLEjacsCells.appendChild(THEADjacsCells);THEADjacsCells.appendChild(TRjacsCells);TRjacsCells.appendChild(TDjacsCells);for(var l=0;l<7;l++){TDjacsCells=document.createElement("td");TDjacsCells.className="jacsWeek";TDjacsCells.id=m+"WeekInit"+l;TRjacsCells.appendChild(TDjacsCells)}TBODYjacsCells=document.createElement("tbody");TBODYjacsCells.id=m+"Cells";TABLEjacsCells.appendChild(TBODYjacsCells);for(var l=0;l<6;l++){TRjacsCells=document.createElement("tr");TBODYjacsCells.appendChild(TRjacsCells);TDjacsCells=document.createElement("td");TDjacsCells.className="jacsWeekNo";TDjacsCells.id=m+"Week_"+l;TRjacsCells.appendChild(TDjacsCells);for(var k=0;k<7;k++){TDjacsCells=document.createElement("td");TDjacsCells.className="jacsCells";TDjacsCells.id=m+"Cell_"+(k+(l*7));TRjacsCells.appendChild(TDjacsCells)}}TFOOTjacsFoot=document.createElement("tfoot");TABLEjacsCells.appendChild(TFOOTjacsFoot);TRjacsFoot=document.createElement("tr");TRjacsFoot.id=m+"Foot";TFOOTjacsFoot.appendChild(TRjacsFoot);TDjacsFoot=document.createElement("td");TDjacsFoot.colSpan="8";TDjacsFoot.style.padding="0px";TRjacsFoot.appendChild(TDjacsFoot);TABLEjacsFootDetail=document.createElement("table");TABLEjacsFootDetail.style.width="100%";TABLEjacsFootDetail.cellSpacing="0";TABLEjacsFootDetail.cellPadding="0";TDjacsFoot.appendChild(TABLEjacsFootDetail);TBODYjacsFootDetail=document.createElement("tbody");TABLEjacsFootDetail.appendChild(TBODYjacsFootDetail);TRjacsFootDetail=document.createElement("tr");TBODYjacsFootDetail.appendChild(TRjacsFootDetail);TDjacsFootDetail=document.createElement("td");TDjacsFootDetail.className="jacsClear";TDjacsFootDetail.id=m+"Clear";TDjacsFootDetail.style.padding="0px";TRjacsFootDetail.appendChild(TDjacsFootDetail);INPUTjacsClearButton=document.createElement("input");INPUTjacsClearButton.type="button";INPUTjacsClearButton.id=m+"ClearButton";INPUTjacsClearButton.className="Clear";INPUTjacsClearButton.style.textAlign="center";INPUTjacsClearButton.onclick=function(){cal.targetEle.value="";d(m)};TDjacsFootDetail.appendChild(INPUTjacsClearButton);TDjacsNow=document.createElement("td");TDjacsNow.className="jacsNow";TDjacsNow.id=m+"Now";TDjacsNow.style.padding="0px";TRjacsFootDetail.appendChild(TDjacsNow);if(TABLEjacs.clickToHide){if(document.addEventListener){TABLEjacs.addEventListener("click",n,false);TABLEjacs.addEventListener("change",n,false);TDjacsDrag.addEventListener("mousedown",o,false);INPUTjacsHead1.addEventListener("click",h,false);SELECTjacsHead2.addEventListener("click",h,false);SELECTjacsHead2.addEventListener("change",h,false);SELECTjacsHead3.addEventListener("click",h,false);SELECTjacsHead3.addEventListener("change",h,false);INPUTjacsHead4.addEventListener("click",h,false);TBODYjacsCells.addEventListener("click",h,false)}else{TABLEjacs.attachEvent("onclick",n);TABLEjacs.attachEvent("onchange",n);TDjacsDrag.attachEvent("onmousedown",o);INPUTjacsHead1.attachEvent("onclick",h);SELECTjacsHead2.attachEvent("onclick",h);SELECTjacsHead2.attachEvent("onchange",h);SELECTjacsHead3.attachEvent("onclick",h);SELECTjacsHead3.attachEvent("onchange",h);INPUTjacsHead4.attachEvent("onclick",h);TBODYjacsCells.attachEvent("onclick",h)}}else{if(document.addEventListener){TABLEjacs.addEventListener("click",h,false);TABLEjacs.addEventListener("change",h,false);TDjacsDrag.addEventListener("mousedown",o,false)}else{TABLEjacs.attachEvent("onclick",h);TABLEjacs.attachEvent("onchange",h);TDjacsDrag.attachEvent("onmousedown",o)}}if(p){iFrame=document.createElement("iframe");iFrame.className="jacs";iFrame.id=m+"Iframe";if(b("jacsIElt7")){iFrame.src="/jacsblank.html"}iFrame.name="jacsIframe";iFrame.frameborder="0";iFrame.style.zIndex=TABLEjacs.zIndex;document.body.insertBefore(iFrame,document.body.firstChild);document.body.insertBefore(TABLEjacs,iFrame)}else{if(!b("jacsSpan"+m)){document.writeln("<span id='jacsSpan"+m+"'></span>")}b("jacsSpan"+m).appendChild(TABLEjacs)}},cals:function(){return e},next:function(){if(typeof arguments[0]=="string"){calID=arguments[0];inFunc=arguments[1];argPosition=2}else{calID="jacs";inFunc=arguments[0];argPosition=1}if(b(calID)){var j=new Array();for(var k=argPosition;k<arguments.length;k++){j.push(arguments[k])}newFunc=inFunc.jacsRunNext(j,calID);var l=b(calID);if(l.dynamic){l.arrOnNext.push(newFunc)}else{l.onNext=newFunc}}else{alert("ERROR: Calendar object <<"+calID+">> does not exist.\nPlease check that the calendar object id is correct\nand that JACS.show is called before JACS.next.")}}}};
